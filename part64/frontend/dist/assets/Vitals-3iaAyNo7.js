import{j as e}from"./index-DKUSIun3.js";function j({entities:d,catalog:o,presenceDynamics:r}){if(!d||d.length===0)return e.jsx("div",{className:"text-muted text-sm p-4",children:"No vitals signal / バイタル信号なし"});const c=o?.entity_manifest||[],x=new Map(c.filter(s=>s&&s.id).map(s=>[String(s.id),s])),m=new Map((r?.presence_impacts??[]).map(s=>[s.id,s])),t=r?.witness_thread,l=Math.round((t?.continuity_index??0)*100),p=(t?.linked_presences??[]).map(s=>{const a=x.get(s);return a?`${String(a.en??s)} / ${String(a.ja??"")}`:s});return e.jsxs("div",{className:"mt-3 space-y-4",children:[t&&e.jsxs("article",{className:"border border-[rgba(102,217,239,0.34)] rounded-2xl p-4 bg-gradient-to-br from-[rgba(45,46,39,0.94)] via-[rgba(39,40,34,0.92)] to-[rgba(31,32,29,0.94)] shadow-sm",children:[e.jsxs("div",{className:"flex flex-col gap-3 lg:flex-row lg:justify-between lg:items-start",children:[e.jsxs("div",{children:[e.jsxs("h3",{className:"text-xl font-semibold text-ink mb-1",children:[t.en," / ",t.ja]}),e.jsx("p",{className:"text-sm text-muted",children:t.notes_en}),e.jsx("p",{className:"text-xs text-muted mt-1",children:t.notes_ja})]}),e.jsxs("div",{className:"grid grid-cols-3 gap-2 w-full lg:w-auto",children:[e.jsxs("div",{className:"rounded-lg border border-[var(--line)] bg-[rgba(39,40,34,0.88)] px-3 py-2",children:[e.jsx("p",{className:"text-[10px] uppercase tracking-wide text-muted",children:"continuity"}),e.jsxs("p",{className:"font-mono font-semibold text-ink",children:[l,"%"]})]}),e.jsxs("div",{className:"rounded-lg border border-[var(--line)] bg-[rgba(39,40,34,0.88)] px-3 py-2",children:[e.jsx("p",{className:"text-[10px] uppercase tracking-wide text-muted",children:"click pressure"}),e.jsxs("p",{className:"font-mono font-semibold text-ink",children:[Math.round((t.click_pressure??0)*100),"%"]})]}),e.jsxs("div",{className:"rounded-lg border border-[var(--line)] bg-[rgba(39,40,34,0.88)] px-3 py-2",children:[e.jsx("p",{className:"text-[10px] uppercase tracking-wide text-muted",children:"file pressure"}),e.jsxs("p",{className:"font-mono font-semibold text-ink",children:[Math.round((t.file_pressure??0)*100),"%"]})]})]})]}),e.jsxs("div",{className:"mt-3 rounded-xl border border-[var(--line)] bg-[rgba(39,40,34,0.84)] p-3",children:[e.jsx("p",{className:"text-[11px] uppercase tracking-wide text-muted",children:"Continuity Line / 連続線"}),e.jsxs("div",{className:"relative mt-2 h-3 rounded-full overflow-hidden bg-[rgba(31,32,29,0.95)]",children:[e.jsx("div",{className:"absolute inset-y-0 left-0 rounded-full",style:{width:`${l}%`,background:"linear-gradient(90deg, rgba(102,217,239,0.8), rgba(166,226,46,0.72), rgba(174,129,255,0.72))"}}),e.jsx("div",{className:"absolute top-0 bottom-0 w-[2px] bg-white/90",style:{left:`${l}%`}})]}),e.jsxs("p",{className:"text-xs text-muted mt-2",children:["Linked presences: ",p.join(" -> ")||"(none)"]})]}),e.jsxs("div",{className:"mt-3 grid gap-3 md:grid-cols-2",children:[e.jsxs("div",{className:"rounded-xl border border-[var(--line)] bg-[rgba(39,40,34,0.84)] p-3",children:[e.jsx("p",{className:"text-[11px] uppercase tracking-wide text-muted mb-2",children:"Lineage / 来歴"}),e.jsx("div",{className:"space-y-2",children:(t.lineage??[]).map((s,a)=>e.jsxs("div",{className:"rounded-md border border-[var(--line)] bg-[rgba(31,32,29,0.82)] px-2 py-1.5",children:[e.jsxs("p",{className:"text-[11px] text-[#66d9ef] font-mono",children:[s.kind," -> ",s.ref]}),e.jsx("p",{className:"text-[11px] text-muted",children:s.why_ja})]},`${s.kind}-${s.ref}-${a}`))})]}),e.jsxs("div",{className:"rounded-xl border border-[var(--line)] bg-[rgba(39,40,34,0.84)] p-3",children:[e.jsx("p",{className:"text-[11px] uppercase tracking-wide text-muted mb-2",children:"How To Read / 読み方"}),e.jsxs("ol",{className:"space-y-1.5 text-xs text-ink list-decimal pl-4",children:[e.jsx("li",{children:"Tap the field map to bind a target into witness continuity."}),e.jsx("li",{children:"Check lineage rows to see what changed and where it landed."}),e.jsxs("li",{children:["Use ",e.jsx("code",{children:"/say witness_thread ..."})," to narrate why a trace matters."]})]})]})]})]}),e.jsx("div",{className:"grid grid-cols-[repeat(auto-fill,minmax(280px,1fr))] gap-6",children:d.map(s=>{const a=c.find(i=>i.id===s.id)||{en:s.id,ja:"",hue:200},n=m.get(s.id),h=s.id==="witness_thread";return e.jsxs("article",{className:`border-2 rounded-2xl p-5 bg-[rgba(45,46,39,0.9)] shadow-sm hover:shadow-md transition-all group ${h?"border-[rgba(102,217,239,0.48)] shadow-[0_0_0_1px_rgba(102,217,239,0.22)]":"border-[var(--line)]"}`,children:[e.jsxs("div",{className:"flex justify-between items-center mb-4",children:[e.jsx("strong",{className:"text-lg font-bold group-hover:text-[#66d9ef] transition-colors",children:a.en}),e.jsx("span",{className:"text-sm text-muted font-medium bg-bg-0 px-2 py-1 rounded-md",children:a.ja})]}),e.jsxs("div",{className:"pt-3 space-y-2 border-t border-line",children:[e.jsxs("div",{className:"flex justify-between text-sm",children:[e.jsx("span",{className:"text-muted",children:"Pulse / 脈拍"}),e.jsxs("span",{className:"font-mono font-bold text-[#66d9ef]",children:[s.bpm," BPM"]})]}),e.jsxs("div",{className:"flex justify-between text-sm",children:[e.jsx("span",{className:"text-muted",children:"Stability / 安定性"}),e.jsxs("span",{className:"font-mono font-bold text-[#a6e22e]",children:[s.stability,"%"]})]}),e.jsxs("div",{className:"flex justify-between text-sm",children:[e.jsx("span",{className:"text-muted",children:"Resonance / 共鳴"}),e.jsxs("span",{className:"font-mono font-bold text-[#ae81ff]",children:[s.resonance,"Hz"]})]}),s.vitals&&Object.entries(s.vitals).map(([i,u])=>e.jsxs("div",{className:"flex justify-between text-sm pt-1",children:[e.jsx("span",{className:"text-muted capitalize",children:i.replace("_"," ")}),e.jsx("span",{className:"font-mono text-ink",children:u})]},i)),n&&e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"flex justify-between text-sm pt-1",children:[e.jsx("span",{className:"text-muted",children:"File Influence / ファイル影響"}),e.jsxs("span",{className:"font-mono text-ink",children:[Math.round(n.affected_by.files*100),"%"]})]}),e.jsxs("div",{className:"flex justify-between text-sm pt-1",children:[e.jsx("span",{className:"text-muted",children:"Click Influence / クリック影響"}),e.jsxs("span",{className:"font-mono text-ink",children:[Math.round(n.affected_by.clicks*100),"%"]})]}),typeof n.affected_by.resource=="number"?e.jsxs("div",{className:"flex justify-between text-sm pt-1",children:[e.jsx("span",{className:"text-muted",children:"Resource Influence / 資源影響"}),e.jsxs("span",{className:"font-mono text-ink",children:[Math.round(n.affected_by.resource*100),"%"]})]}):null,e.jsxs("div",{className:"flex justify-between text-sm pt-1",children:[e.jsx("span",{className:"text-muted",children:"World Effect / 場への波及"}),e.jsxs("span",{className:"font-mono text-ink",children:[Math.round(n.affects.world*100),"%"]})]}),e.jsx("p",{className:"text-xs text-muted pt-1",children:n.notes_ja})]})]}),e.jsx("div",{className:"mt-4 h-2 bg-bg-1 rounded-full overflow-hidden",children:e.jsx("div",{className:"h-full transition-[width] duration-1000 ease-in-out",style:{width:`${s.stability}%`,backgroundColor:`hsl(${a.hue}, 70%, 60%)`}})})]},s.id)})})]})}export{j as VitalsPanel};
